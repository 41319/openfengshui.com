{"version":3,"sources":["webpack:///./src/components/Square/FlyingStar.js","webpack:///./src/components/FlyingStar/index.js","webpack:///./src/cm-lib/XuanKongFlyingStar/index.js","webpack:///./src/components/Picker/index.js","webpack:///./src/components/Picker/Period.js","webpack:///./src/components/Picker/Direction.js","webpack:///./src/containers/FlyingStar.js","webpack:///./src/pages/flyingstar/chart.js","webpack:///./node_modules/date-fns/esm/differenceInCalendarMonths/index.js"],"names":["MountainStar","styled","div","WaterStar","BaseStar","FlyingStarSquare","index","props","size","React","useContext","ResponsiveContext","Text","color","mountainNumber","waterNumber","baseNumber","BoxWrapper","Box","Home","chart","alignSelf","justify","direction","wrap","fill","withDirection","map","e","i","border","Square","data","structure","Template","QiMen","createFlyingstarChart","facing","period","basePlate","createBasePlate","facingMountain","TWENTY_FOUR_MOUNTAIN","find","toLowerCase","sittingDirection","sitting","slice","facingDirection","sittingStar","DIRECTION_PALACE","facingStar","sittingPlate","createPlate","charAt","length","facingPlate","DIRECTION","generateSequence","sequenceStart","startIndex","ascending","sequence","Array","keys","reverse","concat","star","sector","arrangePattern","generate","type","includes","getStarFlight","FORWARD_LUO_SHU_PATTERN","pattern","findIndex","DateTimePicker","onChange","options","initialValue","useState","value","selectedValue","setSelectedValue","useEffect","Select","option","labelKey","valueKey","key","reduce","Period","Object","label","parseInt","Picker","toUpperCase","onDateChanged","date","handleSearch","setPeriod","setFacing","Direction","differenceInCalendarMonths","dirtyDateLeft","dirtyDateRight","arguments","dateLeft","dateRight","yearDiff","getFullYear","monthDiff","getMonth"],"mappings":"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","file":"component---src-pages-flyingstar-chart-js-264a86dcdc0325a2b6a4.js","sourcesContent":["import React from 'react';\nimport { Text, ResponsiveContext } from 'grommet'\nimport styled from 'styled-components'\nimport { base } from \"grommet\";\nimport { Symbol } from './Styles'\n\n\nconst MountainStar = styled.div`\n    position absolute;\n    left: 20px;\n    top: 30px;\n    width: 20px;\n    text-align: center;\n`\n\nconst WaterStar = styled.div`\n    position absolute;\n    right: 20px;\n    top: 30px;\n    width: 20px;\n    text-align: center;\n`\n\nconst BaseStar = styled.div`\n    position absolute;\n    left: 50%;\n    top: 80px;\n\n    width: 20px;\n    text-align: center;\n    margin-left: -10px;\n`\nconst FlyingStarSquare = ({ index, ...props }) => {\n    const cardinal = [\"SE\", \"S\", \"SW\", \"E\", \"\", \"W\", \"NE\", \"N\", \"NW\"]\n    const size = React.useContext(ResponsiveContext);\n    return (\n        <>\n            <MountainStar><Text color=\"white\" size=\"xlarge\">{ props.mountainNumber }</Text></MountainStar>\n            <WaterStar><Text color=\"white\" size=\"xlarge\">{ props.waterNumber }</Text></WaterStar>\n            \n            <BaseStar><Text color=\"white\" size=\"xlarge\"> { props.baseNumber }</Text></BaseStar>\n            <Symbol index={8}>\n                <Text color=\"white\" size={size}>{ cardinal[index] }</Text>\n            </Symbol>\n        </>\n    );\n}\nexport default FlyingStarSquare;","import React from \"react\"\nimport { Box, Button } from 'grommet';\nimport styled from 'styled-components'\nimport Square from '../Square'\nimport QiMen from '../Square/FlyingStar'\nimport { withDirection } from '../../helpers'\n\nconst BoxWrapper = styled(Box)`\n  width: 32%;\n  margin: 2px;\n`\n\nconst Home = ({ chart }) => {\n  return <>\n  <Box \n    alignSelf=\"center\"\n    justify=\"center\"\n    direction=\"row\"\n    wrap={true}\n    fill=\"horizontal\"\n  >\n\n  {\n    chart && withDirection(chart).map((e, i) => <BoxWrapper\n      border={true}\n    >\n        \n    <Square direction={e.direction} data={{\n        structure: chart.structure,\n        ...e,\n        index: i\n      }} Template={QiMen} />\n    </BoxWrapper>)\n  }\n  </Box>\n\n  </>\n}\n\nexport default Home\n","import { TWENTY_FOUR_MOUNTAIN, FORWARD_LUO_SHU_PATTERN, DIRECTION_PALACE, DIRECTION, SOLAR_TERM } from '../constants';\nimport { gregorianToBazi } from '../FourPillar'\nimport { differenceInCalendarMonths } from 'date-fns';\n\nexport const createFlyingstarChart = (facing, period) => {\n\n    const basePlate = createBasePlate(period);\n    const facingMountain = TWENTY_FOUR_MOUNTAIN.find(e => e.facing === facing.toLowerCase());\n    const sittingDirection = facingMountain.sitting.slice(0, -1);\n    const facingDirection = facingMountain.facing.slice(0, -1);\n    const sittingStar = basePlate[DIRECTION_PALACE[sittingDirection]]\n    const facingStar = basePlate[DIRECTION_PALACE[facingDirection]]\n    const sittingPlate = createPlate(sittingStar, facingMountain.sitting.charAt(facingMountain.sitting.length-1), period);\n    const facingPlate = createPlate(facingStar, facingMountain.facing.charAt(facingMountain.facing.length-1), period);\n    \n    return basePlate.map((baseNumber, i) => ({ baseNumber, mountainNumber: sittingPlate[i], waterNumber: facingPlate[i], direction: DIRECTION[i] }))\n}\n\nexport const getStarFlight = (star, sector, period) => {\n   \n    const compareStar = star === 5 ? period : star;\n    const generate = type => generateSequence(1, 9, type ? star - 1 : 9 - star, type);\n    if([1, 3, 7, 9].includes(compareStar)) {\n        return generate(sector === '1');\n    } else {\n        return generate(!(sector === '1'));\n    } \n}\n\nexport const generateSequence = (sequenceStart, length, startIndex, ascending) => {\n    const sequence = ascending ? [...Array(length).keys()].map(e => sequenceStart + e) : \n    [...Array(length).keys()].map(e => sequenceStart + e).slice().reverse();\n\n    return sequence.slice(startIndex).concat(sequence.slice(0, startIndex))\n}\n\nconst createPlate = (star, sector, period) => {\n    return arrangePattern(getStarFlight(star, sector, period), FORWARD_LUO_SHU_PATTERN);\n}\n\nexport const createBasePlate = (period) => {\n    const basePlate = [...Array(9).keys()].map((e, i) => (period + i) > 9 ? (period + i) % 9 : (period + i))\n    return arrangePattern(basePlate, FORWARD_LUO_SHU_PATTERN)\n}\n\nexport const arrangePattern = (data, pattern) => {\n    return data.map((e, i) => data[pattern.findIndex(e => i === e)])\n}\n\nexport const getPeriodByYear = (year) => Math.floor((year - 1864) / 20) + 1\n\nexport const calculateYearPeriod = date => {\n    const bazi = gregorianToBazi(date.getFullYear(), date.getMonth() + 1 , date.getDate(), date.getHours());\n    const year = [\"小寒\", \"大寒\"].find(e => e === bazi.solarTerm) ? date.getFullYear() - 1 : date.getFullYear();\n    return getPeriodByYear(year);\n}\n\nexport const getAnnualStar = date => {\n    const bazi = gregorianToBazi(date.getFullYear(), date.getMonth() + 1 , date.getDate(), date.getHours());\n    const year = [\"小寒\", \"大寒\", \"冬至\"].find(e => e === bazi.solarTerm) && [0, 1].includes(date.getMonth()) ? date.getFullYear() - 1 : date.getFullYear();\n    const diff = year - 1900;\n    const YEAR1900_STAR = 1\n    const move = (YEAR1900_STAR - diff % 9) < 0 ? 9 + (YEAR1900_STAR - diff % 9) : (YEAR1900_STAR - diff % 9);\n    return move === 0 ? 9 : move;\n}\n\nexport const getMonthlyStar = date => {\n    const numericMonth = date.getMonth() + 1;\n    const bazi = gregorianToBazi(date.getFullYear(), numericMonth, date.getDate(), date.getHours());\n    const termIndex = SOLAR_TERM.findIndex(e => e === bazi.solarTerm);\n    const termBorderIndex = Math.floor(numericMonth * 2 - 1) - 1;\n    \n    let caliberate = 0;\n    if(termIndex < termBorderIndex || termBorderIndex === 0 && termIndex === 23) {\n        caliberate = -1;\n    }\n    \n    const jan1900 = new Date(1900, 0, 10, 11);\n    const diff = differenceInCalendarMonths(date, jan1900) + caliberate\n    const YEAR1900JAN_STAR = 9\n    const move = (YEAR1900JAN_STAR - diff % 9) < 0 ? 9 + (YEAR1900JAN_STAR - diff % 9) : (YEAR1900JAN_STAR - diff % 9);\n    return move === 0 ? 9 : move;\n}\n\nexport const calculatePersonalGuaByYear = (year, gender) => {\n    const last2Digit = year.toString().substr(2);\n    let num = last2Digit.split('');\n    while(num.length > 1) {\n        num = (Number(num[0]) + Number(num[1])).toString().split('')\n    }\n\n    if(year >= 2000) {\n        const addNumber = gender === 'M' ? -9 : 6;\n        num = (Number(num[0]) + addNumber)\n        num = Math.abs(num === 0 ? 9 : num).toString().split('');\n       \n    } else {\n        const addNumber = gender === 'M' ? -10 : 5;\n        num = Math.abs((Number(num[0]) + addNumber)).toString().split('');\n    }\n    while(num.length > 1) {\n        num = (Number(num[0]) + Number(num[1])).toString().split('')\n    }\n    \n    return Number(num[0]) === 5 ? gender === 'M' ? 2 : 8\n    : Number(num[0])\n}","import React, { useState, useEffect } from 'react';\nimport { DateInput, Box, Select  } from 'grommet';\nimport { parseISO, format, setMinutes, setHours } from 'date-fns';\nimport { TWENTY_FOUR_MOUNTAIN } from '../../cm-lib/constants'\n\nconst DateTimePicker = ({ onChange, options, initialValue }) => {\n    const [selectedValue, setSelectedValue] = useState(initialValue || options[0].value)\n    useEffect(() => {\n        onChange && onChange(selectedValue)\n    }, [selectedValue])\n\n    return <Select\n        options={options}\n        value={selectedValue}\n        onChange={({ option }) => setSelectedValue(option.value)}\n        labelKey=\"label\"\n        valueKey={{ key: 'value', reduce: true  }}\n    />;\n}\n\nexport default DateTimePicker;","import React, { useState, useEffect } from 'react';\nimport { DateInput, Box, Select  } from 'grommet';\nimport Picker from './'\n\nconst Period = ( { onChange }) => {\n    const options = Object.keys([...Array(9).keys()]).map(e => ({\n        label: parseInt(e) + 1,\n        value: parseInt(e) + 1,\n    }))\n    return <>\n        <Picker initialValue={8} options={options} onChange={onChange} />\n    </>;\n}\n\nexport default Period;","import React, { useState, useEffect } from 'react';\nimport { DateInput, Box, Select  } from 'grommet';\nimport Picker from './'\nimport { TWENTY_FOUR_MOUNTAIN } from '../../cm-lib/constants'\n\nconst Period = ( { onChange }) => {\n    const options = TWENTY_FOUR_MOUNTAIN.map(e => ({\n        label: e.facing.toUpperCase(),\n        value: e.facing,\n    }))\n    return <>\n        <Picker options={options} onChange={onChange} />\n    </>;\n}\n\nexport default Period;\n","import React, { useState } from 'react';\nimport FlyingStarChart from '../components/FlyingStar'\nimport { createFlyingstarChart } from '../cm-lib/XuanKongFlyingStar'\nimport PeriodPicker from '../components/Picker/Period'\nimport DirectionPicker from '../components/Picker/Direction'\n\n\nconst Home = ({ onDateChanged, date, handleSearch }) => {\n    const [period, setPeriod] = useState(8);\n    const [facing, setFacing] = useState('s2');\n    return <>\n        <h2>Flying Star</h2>\n        <DirectionPicker onChange={setFacing} />\n        <PeriodPicker onChange={value => setPeriod(value)} />\n        <br />\n        <FlyingStarChart chart={createFlyingstarChart(facing, period)} />\n    </>\n  }\n  \n  export default Home","import React from \"react\"\nimport Layout from '../../containers/layout'\nimport FlyingStar from '../../containers/FlyingStar'\n\nconst Home = () => {\n  return <Layout>\n    <FlyingStar />\n  </Layout>\n}\n\nexport default Home\n","import toDate from '../toDate/index.js';\nimport requiredArgs from '../_lib/requiredArgs/index.js';\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nexport default function differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}"],"sourceRoot":""}