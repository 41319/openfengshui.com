{"version":3,"sources":["webpack:///./src/cm-lib/QiMen/index.js","webpack:///./node_modules/date-fns/esm/addHours/index.js"],"names":["CalenderData","require","searchHourChart","startDate","endDate","searchFormation","result","found","Ju","filter","v","chart","find","g","f","indexOf","map","e","structure","hour","console","log","ju","getZhiRunHourChart","push","dirtyDate","dirtyAmount","requiredArgs","arguments","amount","toInteger","addMilliseconds","addHours","dt","bazi","dateObjectToBazi","yearMonthKey","format","dayOfMonth","GanZhiHour","ganzhi","chiefPalace","findIndex","god","originalStarPalace","STAR","profile","dayStem","GanZhiDay","substring","hourStem","divineBless","findDivineBlessing","palace","divineLight","findDivineLight","divineForce","findDivineForce","isoString","toISOString","title","label","getDayChart","year","month","day","n","lookup","9","1","3","7","6","4","gregorianToBazi","start","Object","keys","startJu","includes","solarTerm","chartType","index","SIXTY_PILLAR","Number","pillar","findSymbol","star","key","word","DIRECTION","symbol","getMonthChart","slice","GanZhiYear","i","GanZhiMonth"],"mappings":"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","file":"2f909eb3534a22a61acec9154986d3ec4fe6e083-1144896a8d20714333a8.js","sourcesContent":["import { format } from 'date-fns';\nimport { gregorianToBazi, dateObjectToBazi } from '../FourPillar'\nimport { SIXTY_PILLAR, DIRECTION, QM_SAN_YUAN, SIXTY_FOUR, TRIGRAM_BINARY, STAR, DOOR } from '../constants'\nimport Ju from '../reference/Ju.json'\nimport { addHours } from 'date-fns';\nconst CalenderData = require('./Calendar.json');\n\n\nexport const searchHourChart = (startDate, endDate, searchFormation) => {\n\n    const result = []\n    const found = Ju.filter(v => v.chart.find(g => searchFormation && g.f && g.f.indexOf(searchFormation) > -1 ))\n    .map(e => ({ structure: e.structure, hour: e.hour }))\n    console.log(found)\n    while(startDate < endDate) {\n        const ju = getZhiRunHourChart(startDate);\n\n        if(found.find(e => ju.ju.structure === e.structure && ju.ju.hour === e.hour)) {\n\n            result.push(startDate)\n        }\n        startDate = addHours(startDate, 2)\n    }\n    return result;\n}\n\nexport const getZhiRunHourChart = dt => {\n    const bazi = dateObjectToBazi(dt);\n    const yearMonthKey = format(dt, 'yyyyMM')\n    const dayOfMonth = format(dt, 'd')\n    const structure = CalenderData[yearMonthKey][dayOfMonth - 1];\n    const ju = Ju.find(e => e.structure === structure && e.hour === bazi.GanZhiHour.ganzhi);\n    \n    const chiefPalace = ju.chart.findIndex(e => e.god === '符');\n    const originalStarPalace = STAR[chiefPalace > 4 ? chiefPalace - 1 : chiefPalace]\n    const profile = {\n        dayStem: bazi.GanZhiDay.ganzhi.substring(0, 1),\n        hourStem: bazi.GanZhiHour.ganzhi.substring(0, 1),\n        divineBless: findDivineBlessing(ju.chart).palace,\n        divineLight: findDivineLight(ju.chart, originalStarPalace).palace,\n        divineForce: findDivineForce(ju.chart).palace\n    }\n    return {\n        ju: {\n            ...ju,\n            isoString: dt.toISOString(),\n            bazi\n        },\n        profile: [\n            {\n                title: 'Day Stem',\n                label: profile.dayStem\n            },\n            {\n                title: 'Hour Stem',\n                label: profile.hourStem\n            },\n            {\n                title: 'Divine Blessing',\n                label: profile.divineBless\n            },\n            {\n                title: 'Divine Light',\n                label: profile.divineLight\n            },\n            {\n                title: 'Divine Force',\n                label: profile.divineForce\n            },\n        ]\n    }\n}\n\nexport const getChaiBuHour = (bazi) => {\n    const chart = getQMCBChart(bazi);\n    const type = Object.keys(QM_SAN_YUAN).findIndex(e => e === bazi.solarTerm) < 12 ? 'M' : 'F';\n    return {\n        pillar: bazi.GanZhiHour.ganzhi,\n        structure: `${type}${chart.substr(1, 1)}`\n    }\n}\n\nexport const getQMCBChart = (bazi) => {\n    const branchYuan = [\n        ['子', '卯', '午', '酉'],\n        ['寅', '巳', '申', '亥'],\n        ['丑', '辰', '未', '戌']\n    ]\n\n    const reverseSixty = [...SIXTY_PILLAR.slice().reverse(), ...SIXTY_PILLAR.slice().reverse()];\n    const rest = reverseSixty.slice(reverseSixty.findIndex(e => e === bazi.GanZhiDay.ganzhi));\n\n    const fuTouBranch = rest.find(e => ['己', '甲'].includes(e.substr(0, 1))).substr(1, 1)\n    const yuan = branchYuan.findIndex(e => e.includes(fuTouBranch));\n    const type = Object.keys(QM_SAN_YUAN).findIndex(e => e === bazi.solarTerm) < 12 ? 'M' : 'F';\n    \n    return `${type}${QM_SAN_YUAN[bazi.solarTerm][yuan]}`;\n}\n\nconst getQMChart = (y, m, d, h) => {\n    const calDate = new Date(y, m - 1, d);\n    const yearMonthKey = format(calDate, 'yyyyMM');\n    const dayIndex = Number(format(calDate, 'd')) - 1;\n    return {\n        pillar: h,\n        structure: CalenderData[yearMonthKey] && CalenderData[yearMonthKey][dayIndex]\n    }\n}\n\nexport const getZRQMHourChart = (y, m, d, h) => {\n    return getHourChart(gregorianToBazi(y, m, d, h))\n}\n\nexport const getHourChart = (bazi) => {\n    return getQMChart(bazi.westernYear, bazi.westernMonth, bazi.westernDay, bazi.GanZhiHour.ganzhi);\n}\n\nexport const searchChart = (filterObject, haystack) => {\n    return haystack.filter(v => {\n        const kk =  v.chart.map((obj, i) => {\n            const compare = filterObject[i];\n            const l = Object.keys(compare).map(k => {\n                const o = compare[k];\n                return o === '' ? true : o.indexOf(obj[k]) > -1 ? true : false; \n            })\n            return l.every(e => e);\n        })\n        return kk.every(e => e);\n    }).map(e => ({ structure: e.structure, hour: e.hour }))\n}\n\n\nconst element = {\n    red: ['丁', '丙', '景', '英', '巳', '午', '離'],\n    blue: ['壬', '癸', '休', '蓬', '子', '亥', '坎'],\n    '#145A32': ['乙', '杜', '傷', '辅', '沖', '輔', '寅', '卯', '震', '巽', '甲'],\n    \"#6E2C00\": ['戊', '己', '死', '生', '芮', '任', '丑', '辰', '未', '戌', '艮', '坤'],\n    'gray': ['庚', '辛', '开', '柱', '心', '驚', '開', '申', '酉', '乾', '兌'],\n}\n\nexport const getColor = word => {\n    const color = Object.keys(element);\n    return color.find(colorCode => element[colorCode].includes(word));\n}\n\nexport const getDayChart = (year, month, day) => {\n    const lookup = {\n        9: [\"夏至\", \"小暑\", \"大暑\", \"立秋\"],\n        1: [\"冬至\", \"小寒\", \"大寒\", \"立春\"],\n        3: [\"处暑\", \"白露\", \"秋分\", \"寒露\"],\n        7: [\"雨水\", \"惊蛰\", \"春分\", \"清明\"],\n        6: [\"霜降\", \"立冬\", \"小雪\", \"大雪\"],\n        4: [\"谷雨\", \"立夏\", \"小满\", \"芒种\"],\n    }\n    const removeSign = n => n < 0 ? n * -1 : n;\n    const bazi = gregorianToBazi(year, month, day, 12);\n    const start = Object.keys(lookup).find(startJu => lookup[startJu].includes(bazi.solarTerm));\n    const chartType = [\"1\", \"7\", \"4\"].includes(start) ? 'M' : 'F';\n    const index = SIXTY_PILLAR.indexOf(bazi.GanZhiDay.ganzhi);\n    const chart =  chartType === 'M' ? ((index - 1) + Number(start)) % 9 : removeSign((start) - Number(index)) % 9\n    const structure = chartType === 'M' ? `${chartType}${chart + 1}` : `${chartType}${9 - chart}`;\n    return  { structure, pillar: bazi.GanZhiDay.ganzhi }\n}\n\nexport const matchCriteria = (chart1, chart2, palaceIndex, contains) => {\n    \n    return contains.filter(e => [\n        chart1[palaceIndex].god,\n        chart1[palaceIndex].door,\n        chart1[palaceIndex].star,\n        chart2[palaceIndex].god,\n        chart2[palaceIndex].door,\n        chart2[palaceIndex].star\n    ].includes(e)).length === contains.length\n    \n\n}\n\nexport const findDivineBlessing = chart => findSymbol(chart, 'god', '天')\n\nexport const findDivineLight = (chart, star) => findSymbol(chart, 'star', star)\n\nexport const findDivineForce = chart => findSymbol(chart, 'door', '生')\n\nexport const findSymbol = (chart, key, word) => {\n    return { palace: DIRECTION[chart.findIndex(e => e[key] === word)], symbol: word }\n}\n\nexport const starDoorToHexagram = (star, door) => {\n    const doorBinaryIndex = DOOR.findIndex(e => e === door);\n    const starBinaryIndex = STAR.findIndex(e => e === star);\n\n    const hexBinary = TRIGRAM_BINARY[doorBinaryIndex] + TRIGRAM_BINARY[starBinaryIndex];\n    return SIXTY_FOUR[hexBinary]\n}\n\n\n\nexport const getMonthChart = (year, month, day) => {\n    const yin = [1, 4, 7];\n    const bazi = gregorianToBazi(year, month, day, 12);\n\n\n    const lookup = [\n        ...SIXTY_PILLAR.slice(0, 5),\n        ...SIXTY_PILLAR.slice(15, 20),\n        ...SIXTY_PILLAR.slice(30, 35),\n        ...SIXTY_PILLAR.slice(45, 50),\n\n        ...SIXTY_PILLAR.slice(5, 10),\n        ...SIXTY_PILLAR.slice(20, 25),\n        ...SIXTY_PILLAR.slice(35, 40),\n        ...SIXTY_PILLAR.slice(50, 55),\n        \n        ...SIXTY_PILLAR.slice(10, 15),\n        ...SIXTY_PILLAR.slice(25, 30),\n        ...SIXTY_PILLAR.slice(40, 45),\n        ...SIXTY_PILLAR.slice(55, 60),\n    ];\n\n    const index = lookup.indexOf(bazi.GanZhiYear.ganzhi);\n    const ju = yin.find((ju, i) => (i * 20 - 1) < index && index < ((i + 1) * 20));\n    const structure = `F${ju}`\n    return { structure, pillar: bazi.GanZhiMonth.ganzhi}\n}\n\nexport const getSanYuanYearChart = date => {\n    const year1928Structure = 9;\n\n    const bazi = gregorianToBazi(date.getFullYear(),date.getMonth() + 1, date.getDate(), date.getHours());\n    const toYear = [\"小寒\", \"大寒\"].includes(bazi.solarTerm) ? date.getFullYear() - 1: date.getFullYear();\n    const newStructure = year1928Structure - ((toYear - 1928) % 9);\n    return {\n        pillar: bazi.GanZhiYear.ganzhi,\n        structure: `F${newStructure}`,\n    };\n}\n\n\n\n\n\n","import toInteger from '../_lib/toInteger/index.js';\nimport addMilliseconds from '../addMilliseconds/index.js';\nimport requiredArgs from '../_lib/requiredArgs/index.js';\nvar MILLISECONDS_IN_HOUR = 3600000;\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * var result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\n\nexport default function addHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_HOUR);\n}"],"sourceRoot":""}